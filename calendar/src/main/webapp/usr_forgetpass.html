<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Forget Password</title>
<!--#include virtual="head.html" -->
<script src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='dwr/interface/AuthService.js'></script>
<script>
	function callback(success, data) {
		if (success) {
			$('#main_panel').css('display', 'none');
			$('#confirm_panel').css('display', 'block');
		} else {
			grecaptcha.reset();
			$('#submit').removeProp('disabled');
		}
	};

	function onload() {

		new otms.validator.NonemptyValidator($('#username'));

		var bm = new otms.validator.BeanManager();
		bm.reg('username', $('#username'));

		$('#submit').click(
				function() {
					var bean = bm.getBean();
					if (bean != null) {
						$('#submit').prop('disabled', 'disabled');
						var captcharesp = grecaptcha.getResponse();
						bean['captcha'] = captcharesp;
						AuthService.reqResetPass(bean, otms.ui.MessageBox
								.shan(callback));
					}
				});

	};

	$(onload);
</script>
</head>
<body>
	<!--#include virtual="navbar.html" -->
	<div class="page">
		<div id="errmsg_panel"></div>
		<div class="page-content-thin">
			<div class="page-title">Forget Password</div>
			<div class="page-block" id="main_panel">
				<div class="page-row">
					<input type='text' id="username"
						placeholder="Please input your username or email address" />
				</div>
				<div class="page-row" style="overflow-y: hidden;">
					<div class="g-recaptcha"
						data-sitekey="6LcVwCQUAAAAABkbKjftIBw5snuZWUYcdaQLSrfW"></div>
				</div>

				<div class="page-row">
					<button id="submit" class="btn_normal">Submit</button>
				</div>
			</div>
			<div id="confirm_panel" class="page-block" style="display: none">
				<div class="page-row">Thank you! A confirmation email had been
					sent to your email box. Follow the instruction to recover your
					password.</div>
			</div>
		</div>
	</div>
	<!--#include virtual="footer.html" -->
</body>
</html>